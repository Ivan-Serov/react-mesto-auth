(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){e.exports=n.p+"static/media/success-icon.e38b395c.svg"},13:function(e,t,n){e.exports=n.p+"static/media/fail-icon.4072126c.svg"},15:function(e,t,n){e.exports=n(65)},65:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(9),i=n.n(r),c=(n(8),n(14)),l=n(2);var s=function(){return o.a.createElement("header",{className:"header"},o.a.createElement("div",{className:"header__logo"}))},u=o.a.createContext();function p(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,r=e.onCardDeleteClick,i=t.owner,c=t.link,l=t.name,s=t.likes,p=o.a.useContext(u),m=i._id===p._id,d="places__delete ".concat(m&&"places__delete_not-visible"),_=s.some(function(e){return e._id===p._id}),f="places__like ".concat(_&&"places__like_active");return o.a.createElement("div",{className:"places__card"},o.a.createElement("img",{src:c,alt:l,className:"places__image",onClick:function(){n(t)}}),o.a.createElement("h2",{className:"places__title"},l," "),o.a.createElement("div",{className:"places__like-container"},o.a.createElement("button",{type:"button",className:f,onClick:function(){a(t)}}),o.a.createElement("p",{className:"places__like-number"},s.length)),o.a.createElement("button",{type:"button",className:d,onClick:function(){r(t)}}))}var m=function(e){var t=e.onEditAvatar,n=e.onEditProfile,a=e.onAddPlace,r=e.onCardClick,i=e.onCardLike,c=e.onCardDeleteClick,l=e.cards,s=o.a.useContext(u);return o.a.createElement("main",null,o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__avatar",onClick:t},o.a.createElement("img",{src:s.avatar,alt:"avatar",className:"profile__foto-avatar"})),o.a.createElement("div",{className:"profile__text-group"},o.a.createElement("div",{className:"profile__title-box"},o.a.createElement("h1",{className:"profile__title"},s.name),o.a.createElement("button",{type:"button",className:"profile__edit",id:"profE",onClick:n})),o.a.createElement("p",{className:"profile__subtitle"},s.about)),o.a.createElement("button",{type:"button",className:"profile__add",onClick:a})),o.a.createElement("section",{className:"places"},l.map(function(e){return o.a.createElement(p,{card:e,onCardClick:r,onCardLike:i,onCardDeleteClick:c,key:e._id})})))};var d=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__author"},"\xa9 2021. \u0418\u0432\u0430\u043d \u0421\u0435\u0440\u043e\u0432"))};function _(e){var t=e.isOpen,n=e.card,a=e.onClose;return o.a.createElement("div",{className:"popup popup_img ".concat(t&&"popup_opened"),id:"popup-image"},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{onClick:a,type:"button",className:"popup__close",id:"popup-close-image"}),o.a.createElement("img",{src:n?n.link:"#",alt:n?n.name:"",className:"popup__image"}),o.a.createElement("h2",{className:"popup__title popup__title_img"},n?n.name:"")))}function f(e){var t=e.name,n=e.title,a=e.children,r=e.isOpen,i=e.onClose,c=e.buttonText,l=e.onSubmit,s="popup ".concat(r&&"popup_opened"),u="popup__form popup__form_".concat(t);return o.a.createElement("div",{className:s},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{type:"button",className:"popup__close",onClick:i}),o.a.createElement("form",{className:u,method:"POST",name:t,onSubmit:l},o.a.createElement("h2",{className:"popup__title"},n),a,o.a.createElement("button",{type:"submit",className:"popup__save"},c))))}function h(e){var t=e.isOpen,n=e.onClose,a=e.onEditUser,r=o.a.useContext(u),i=o.a.useState(""),c=Object(l.a)(i,2),s=c[0],p=c[1],m=o.a.useState(""),d=Object(l.a)(m,2),_=d[0],h=d[1];return o.a.useEffect(function(){p(r.name||""),h(r.about||"")},[r,t]),o.a.createElement(f,{isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:s,about:_})},title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},o.a.createElement("input",{name:"name",id:"user",type:"text",placeholder:"\u0418\u043c\u044f",className:"popup__input popup__input_type_user",minLength:"2",maxLength:"40",required:!0,value:s,onChange:function(e){p(e.target.value)}}),o.a.createElement("span",{id:"user-error",className:"error"}),o.a.createElement("input",{name:"about",id:"user-information",type:"text",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__input popup__input_type_user-information",minLength:"2",maxLength:"200",required:!0,value:_,onChange:function(e){h(e.target.value)}}),o.a.createElement("span",{id:"user-information-error",className:"error"}))}function g(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,r=o.a.useRef();return o.a.createElement(f,{isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({avatar:r.current.value})},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},o.a.createElement("input",{name:"avatar",id:"link-avatar",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_type_image-link",required:!0,ref:r}),o.a.createElement("span",{id:"link-avatar-error",className:"error"}))}function E(e){var t=e.isOpen,n=e.onClose,a=e.onAddPost,r=o.a.useState(""),i=Object(l.a)(r,2),c=i[0],s=i[1],u=o.a.useState(""),p=Object(l.a)(u,2),m=p[0],d=p[1];return o.a.createElement(f,{isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:c,link:m}),s(""),d("")},title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"},o.a.createElement("input",{name:"name",id:"title-location",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__input_type_title",minLength:"2",maxLength:"30",required:!0,value:c,onChange:function(e){s(e.target.value)}}),o.a.createElement("span",{id:"title-location-error",className:"error"}),o.a.createElement("input",{name:"link",id:"link-image",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_type_image-link",required:!0,value:m,onChange:function(e){d(e.target.value)}}),o.a.createElement("span",{id:"link-image-error",className:"error"}))}function v(e){var t=e.isOpen,n=e.onClose,a=e.card,r=e.onDeletePlace;return o.a.createElement(f,{isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),r(a)},title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"delete",buttonText:"\u0414\u0430"})}var b=n(0),N=n(10),k=n(11),C=new(function(){function e(t,n){Object(N.a)(this,e),this.checkResult=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},this._url=t,this._authorizationToken=n,this._headers={authorization:this._authorizationToken,"Content-Type":"application/json"}}return Object(k.a)(e,[{key:"getUserInfo",value:function(){return fetch(this._url+"/users/me",{method:"GET",headers:{authorization:this._authorizationToken}}).then(this.checkResult)}},{key:"getInitialCards",value:function(){return fetch(this._url+"/cards",{headers:{authorization:this._authorizationToken}}).then(this.checkResult)}},{key:"editProfile",value:function(e){return fetch(this._url+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this.checkResult)}},{key:"addPlace",value:function(e){return fetch(this._url+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this.checkResult)}},{key:"deletePost",value:function(e){return fetch(this._url+"/cards/"+e,{method:"DELETE",headers:this._headers}).then(this.checkResult)}},{key:"addLike",value:function(e){return fetch(this._url+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then(this.checkResult)}},{key:"deleteLike",value:function(e){return fetch(this._url+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this.checkResult)}},{key:"addAvatar",value:function(e){return fetch(this._url+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this.checkResult)}}]),e}())("https://nomoreparties.co/v1/cohort-28","d0022a9e-a6be-4d9a-ab6e-3949875c7c34"),O=n(5),j=n(6),y="https://auth.nomoreparties.co",S=function(e,t){return fetch("".concat(y,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)})},L=function(e,t){return fetch("".concat(y,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)})},P=function(e){return fetch("".concat(y,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(function(e){return e.json()}).then(function(e){return e})},w=n(4),T=n(12),x=n.n(T),A=n(13),D=n.n(A);function I(e){return e.errorLogin?o.a.createElement("section",{className:"popup popup_login popup_is-opened"},o.a.createElement("div",{className:"popup__content popup__content_login"},o.a.createElement("button",{className:"popup__close popup__close_login",type:"button",onClick:e.onClosePopup}),o.a.createElement("img",{src:x.a,alt:"\u0423\u0441\u043f\u0435\u0445",className:"popup__icon-login"}),o.a.createElement("h3",{className:"popup__title popup__title_login"},"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"))):e.errorLogin?o.a.createElement("section",{className:"popup popup_login"}):o.a.createElement("section",{className:"popup popup_login popup_is-opened"},o.a.createElement("div",{className:"popup__content popup__content_login"},o.a.createElement("button",{className:"popup__close popup__close_login",type:"button",onClick:e.onClosePopup}),o.a.createElement("img",{src:D.a,alt:"\u041e\u0448\u0438\u0431\u043a\u0430",className:"popup__icon-login"}),o.a.createElement("h3",{className:"popup__title popup__title_login"},"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437")))}function U(){var e=Object(a.useState)({email:"",password:""}),t=Object(l.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)({isOpenLoginPopup:!1,errorLogin:!1,message:""}),c=Object(l.a)(i,2),u=c[0],p=c[1],m=Object(b.g)(),d=function(e){var t=e.target,n=t.name,a=t.value;r(function(e){return Object(j.a)({},e,Object(O.a)({},n,a))})},_=function(e){e.preventDefault(),S(n.email,n.password).then(function(e){e.data?(p({message:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c",errorLogin:!0,isOpenLoginPopup:!1}),f()):(p({message:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!",errorLogin:!1,isOpenLoginPopup:!1}),f())})},f=function(){p(function(e){return Object(j.a)({},e,{isOpenLoginPopup:!0})})};return o.a.createElement("div",{className:"register"},o.a.createElement(s,{nav:"/sign-in",navStatus:"\u0412\u043e\u0439\u0442\u0438",emailUser:""}),o.a.createElement("h1",{className:"register__welcome"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),o.a.createElement("form",{onSubmit:_,className:"register__form"},o.a.createElement("input",{id:"email",name:"email",type:"email",placeholder:"Email",className:"register__input",value:n.email,onChange:d}),o.a.createElement("input",{id:"password",name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"register__input",value:n.password,onChange:d}),o.a.createElement("div",{className:"register__button-container"},o.a.createElement("button",{type:"submit",className:"register__link",onSubmit:_},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"))),o.a.createElement("div",{className:"register__signin"},o.a.createElement("p",null,"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c?"),o.a.createElement(w.b,{to:"/sign-in",className:"register__login-link"},"\u0412\u043e\u0439\u0442\u0438")),u.isOpenLoginPopup&&o.a.createElement(I,{errorLogin:u.errorLogin,onClosePopup:function(){p(function(e){return Object(j.a)({},e,{isOpenLoginPopup:!1})}),u.errorLogin&&m("/sign-in")}}))}function R(e){var t=e.onLogin,n=Object(a.useState)({email:"",password:""}),r=Object(l.a)(n,2),i=r[0],c=r[1],u=Object(b.g)(),p=function(e){var t=e.target,n=t.name,a=t.value;c(function(e){return Object(j.a)({},e,Object(O.a)({},n,a))})},m=function(e){e.preventDefault(),i.email&&i.password&&L(i.email,i.password).then(function(e){e.token&&(c({email:"",password:""}),localStorage.setItem("jwt",e.token),t(i.email),u("/"))}).catch(function(e){return console.log(e)})};return o.a.createElement("div",{className:"login"},o.a.createElement(s,{nav:"/sign-up",navStatus:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",emailUser:""}),o.a.createElement("p",{className:"login__welcome"},"\u0412\u0445\u043e\u0434"),o.a.createElement("form",{onSubmit:m,className:"login__form"},o.a.createElement("input",{id:"email",name:"email",type:"email",placeholder:"Email",className:"login__input",value:i.username,onChange:p}),o.a.createElement("input",{required:!0,id:"password",name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"login__input",value:i.password,onChange:p}),o.a.createElement("div",{className:"login__button-container"},o.a.createElement("button",{type:"submit",className:"login__link",onSubmit:m},"\u0412\u043e\u0439\u0442\u0438"))))}var z=function(e){var t=e.loggedIn,n=e.children;return t?n:o.a.createElement(b.a,{to:"/sign-in"})};var J=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(""),p=Object(l.a)(i,2),f=p[0],N=p[1],k=Object(b.g)(),O=Object(b.f)(),j=o.a.useState(!1),y=Object(l.a)(j,2),S=y[0],L=y[1],w=o.a.useState(!1),T=Object(l.a)(w,2),x=T[0],A=T[1],D=o.a.useState(!1),I=Object(l.a)(D,2),J=I[0],q=I[1],F=o.a.useState(null),B=Object(l.a)(F,2),G=B[0],H=B[1],M=o.a.useState(!1),K=Object(l.a)(M,2),Q=K[0],V=K[1];function W(){L(!1),A(!1),q(!1),H(null),ce(!1),V(!1)}var X=o.a.useState({}),Y=Object(l.a)(X,2),Z=Y[0],$=Y[1];o.a.useEffect(function(){C.getUserInfo().then(function(e){$(e)}).catch(function(e){return console.log(e)})},[]);var ee=o.a.useState([]),te=Object(l.a)(ee,2),ne=te[0],ae=te[1];o.a.useEffect(function(){C.getInitialCards().then(function(e){ae(e)}).catch(function(e){return console.log(e)})},[]);var oe=o.a.useState(!1),re=Object(l.a)(oe,2),ie=re[0],ce=re[1];Object(a.useEffect)(function(){le(O.pathname),Promise.all([C.getUserInfo(),C.getInitialCards()]).then(function(e){$(e[0]),ae(e[1])}).catch(function(e){return console.log(e),[]})},[]);var le=function(e){if(localStorage.getItem("jwt")){var t=localStorage.getItem("jwt");P(t).then(function(t){t&&(r(!0),N(t.data.email),k(e))})}};return o.a.createElement(u.Provider,{value:Z},o.a.createElement("div",{className:"page"},o.a.createElement(b.d,null,o.a.createElement(b.b,{path:"/",element:o.a.createElement(z,{loggedIn:n},o.a.createElement("div",null,o.a.createElement(s,{nav:"/sign-in",navStatus:"\u0412\u044b\u0439\u0442\u0438",emailUser:f,onLogout:function(e){e.preventDefault(),localStorage.removeItem("jwt"),r(!1),N(""),k("/sign-in")}}),o.a.createElement(m,{onEditProfile:function(){L(!0)},onAddPlace:function(){A(!0)},onEditAvatar:function(){q(!0)},onCardClick:function(e){H(e),V(!0)},onCardLike:function(e){e.likes.some(function(e){return e._id===Z._id})?C.deleteLike(e._id).then(function(t){ae(function(n){return n.map(function(n){return n._id===e._id?t:n})})}).catch(function(e){return console.log(e),[]}):C.addLike(e._id).then(function(t){ae(function(n){return n.map(function(n){return n._id===e._id?t:n})})}).catch(function(e){return console.log(e),[]})},onCardDeleteClick:function(e){ce(!0),H(e)},cards:ne}),o.a.createElement(d,null),o.a.createElement(h,{isOpen:S,onClose:W,onEditUser:function(e){C.editProfile(e).then(function(e){$(e),W()}).catch(function(e){return console.log(e)})}}),o.a.createElement(E,{isOpen:x,onClose:W,onAddPost:function(e){C.addPlace(e).then(function(e){ae([e].concat(Object(c.a)(ne))),W()}).catch(function(e){return console.log(e)})}}),o.a.createElement(g,{isOpen:J,onClose:W,onUpdateAvatar:function(e){C.addAvatar(e).then(function(e){$(e),W()}).catch(function(e){return console.log(e)})}}),o.a.createElement(_,{isOpen:Q,card:G,onClose:W}),o.a.createElement(v,{isOpen:ie,onClose:W,card:G,onDeletePlace:function(e){C.deletePost(e._id).then(function(){ae(function(t){return t.filter(function(t){return t._id!==e._id})}),W()}).catch(function(e){return console.log(e)})}})))}),o.a.createElement(b.b,{path:"/sign-up",element:o.a.createElement(U,null)}),o.a.createElement(b.b,{path:"/sign-in",element:o.a.createElement(R,{onLogin:function(e){r(!0),N(e)}})}))))},q=function(e){e&&e instanceof Function&&n.e(1).then(n.bind(null,66)).then(function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),r(e),i(e)})};i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(w.a,null,o.a.createElement(J,null))),document.getElementById("root")),q()},8:function(e,t,n){}},[[15,3,2]]]);
//# sourceMappingURL=main.36dd46ec.chunk.js.map